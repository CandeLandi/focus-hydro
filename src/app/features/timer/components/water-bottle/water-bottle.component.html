<div class="relative w-56 h-80">
  <!-- Bottle Container -->
  <svg viewBox="0 0 200 320" class="w-full h-full drop-shadow-2xl" xmlns="http://www.w3.org/2000/svg">
    <!-- Bottle Cap -->
    <rect x="70" y="10" width="60" height="25" rx="8" class="fill-cyan-500 stroke-cyan-400" stroke-width="2" />
    <rect
      x="65"
      y="30"
      width="70"
      height="20"
      rx="5"
      class="fill-cyan-600 stroke-cyan-500"
      stroke-width="2"
    />

    <!-- Bottle Neck -->
    <path
      d="M 75 50 L 70 70 L 70 85 Q 70 90 75 90 L 125 90 Q 130 90 130 85 L 130 70 L 125 50 Z"
      class="fill-slate-800 stroke-cyan-400"
      stroke-width="3"
    />

    <!-- Main Bottle Body - Glass effect -->
    <rect
      x="45"
      y="90"
      width="110"
      height="215"
      rx="20"
      class="fill-slate-900 stroke-cyan-400"
      stroke-width="4"
    />

    <!-- Water Fill with realistic gradient -->
    <defs>
      <linearGradient id="waterGradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#06b6d4" stop-opacity="0.85" />
        <stop offset="40%" stop-color="#0891b2" stop-opacity="0.9" />
        <stop offset="100%" stop-color="#0e7490" stop-opacity="0.95" />
      </linearGradient>

      <radialGradient id="bubbleGradient">
        <stop offset="0%" stop-color="white" stop-opacity="0.8" />
        <stop offset="70%" stop-color="#a5f3fc" stop-opacity="0.4" />
        <stop offset="100%" stop-color="#06b6d4" stop-opacity="0.1" />
      </radialGradient>

      <clipPath id="bottleClip">
        <rect x="49" y="94" width="102" height="207" rx="16" />
      </clipPath>
    </defs>

    <!-- Water inside bottle -->
    <g clip-path="url(#bottleClip)">
      <rect
        x="49"
        [attr.y]="waterY()"
        width="102"
        [attr.height]="waterHeight()"
        fill="url(#waterGradient)"
        class="transition-all duration-1000 ease-out"
      />

      <!-- Animated water surface waves -->
      @if (shouldShowWaves()) {
        <path
          [attr.d]="'M 49 ' + waterY() + ' Q 75 ' + (waterY() - 3) + ' 100 ' + waterY() + ' T 151 ' + waterY() + ' L 151 ' + (waterY() + 5) + ' L 49 ' + (waterY() + 5) + ' Z'"
          fill="#06b6d4"
          opacity="0.6"
          class="animate-wave"
        />
        <path
          [attr.d]="'M 49 ' + (waterY() + 2) + ' Q 75 ' + (waterY() + 5) + ' 100 ' + (waterY() + 2) + ' T 151 ' + (waterY() + 2) + ' L 151 ' + (waterY() + 7) + ' L 49 ' + (waterY() + 7) + ' Z'"
          fill="#0891b2"
          opacity="0.4"
          class="animate-wave"
          style="animation-delay: 0.5s"
        />
      }

      @if (shouldShowBubbles()) {
        <circle
          cx="75"
          [attr.cy]="waterY() + waterHeight() * 0.3"
          r="8"
          fill="url(#bubbleGradient)"
          class="animate-float"
        />
        <circle
          cx="120"
          [attr.cy]="waterY() + waterHeight() * 0.5"
          r="6"
          fill="url(#bubbleGradient)"
          class="animate-float"
          style="animation-delay: 0.3s"
        />

        @if (shouldShowMoreBubbles()) {
          <circle
            cx="90"
            [attr.cy]="waterY() + waterHeight() * 0.7"
            r="5"
            fill="url(#bubbleGradient)"
            class="animate-float"
            style="animation-delay: 0.6s"
          />
          <circle
            cx="110"
            [attr.cy]="waterY() + waterHeight() * 0.85"
            r="7"
            fill="url(#bubbleGradient)"
            class="animate-float"
            style="animation-delay: 0.9s"
          />
        }
      }
    </g>

    <!-- Glass shine effects -->
    <ellipse cx="75" cy="160" rx="18" ry="50" fill="white" opacity="0.15" />
    <ellipse cx="135" cy="220" rx="12" ry="35" fill="white" opacity="0.08" />

    <!-- Bottle outline for depth -->
    <rect
      x="45"
      y="90"
      width="110"
      height="215"
      rx="20"
      fill="none"
      class="stroke-cyan-400"
      stroke-width="2"
    />

    <!-- Water level measurement marks -->
    @for (level of [25, 50, 75]; track level) {
      <g>
        <line
          x1="38"
          [attr.y1]="94 + (207 * (100 - level)) / 100"
          x2="48"
          [attr.y2]="94 + (207 * (100 - level)) / 100"
          class="stroke-cyan-400"
          stroke-width="2"
        />
        <line
          x1="152"
          [attr.y1]="94 + (207 * (100 - level)) / 100"
          x2="162"
          [attr.y2]="94 + (207 * (100 - level)) / 100"
          class="stroke-cyan-400"
          stroke-width="2"
        />
      </g>
    }
  </svg>

</div>
